(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var Timer=require("./model.js");var parseInput=require("./parseInput.js");var Controller=function(){var that=this;this._timer=null;this._buttonClickProcessing=function(event){var input=parseInput();if(!input.isValid)throw"Wrong input.";switch(event.target||event.srcElement){case window.Prompter.$buttonCountUp:if(!that._timer){that._timer=new Timer("count-up",input.value)}else if(that._timer.type==="count-up"&&!that._timer.paused){that._timer.pause()}else if(that._timer.type==="count-up"&&that._timer.paused){that._timer.run()}break;case window.Prompter.$buttonCountDown:if(!that._timer){that._timer=new Timer("count-down",input.value)}else if(that._timer.type==="count-down"&&!that._timer.paused){that._timer.pause()}else if(that._timer.type==="count-down"&&that._timer.paused){that._timer.run()}break;case window.Prompter.$buttonCountDeadline:if(!that._timer){that._timer=new Timer("deadline",input.value)}break;case window.Prompter.$buttonReset:if(that._timer)that._timer.cancel();that._timer=null;break}};window.Prompter.$body.addEventListener("click",that._buttonClickProcessing)};module.exports=Controller},{"./model.js":7,"./parseInput.js":8}],2:[function(require,module,exports){module.exports=function(timeInSeconds,fullFormat){var h=Math.floor(timeInSeconds/3600);var m=Math.floor((timeInSeconds-h*3600)/60);var s=Math.floor(timeInSeconds-h*3600-m*60);var timeString=":"+(s<10?"0"+s:s);if(fullFormat){timeString=(h<10?"0"+h:h)+":"+(m<10?"0"+m:m)+timeString}else{if(h>0){timeString=h+":"+(m<10?"0"+m:m)+timeString}else{timeString=m+timeString}}return timeString}},{}],3:[function(require,module,exports){module.exports=function(){var temp=window.Prompter.View.$messageOnPrompter.textContent;window.Prompter.View.$messageOnPrompter.textContent="";var scrollHeight,toggle=true;var id=setInterval(cutContentToFitDiv,4);function cutContentToFitDiv(){if(!scrollHeight)scrollHeight=window.Prompter.View.$messageOnPrompter.scrollHeight;if(toggle){window.Prompter.View.$messageOnPrompter.textContent=temp;toggle=false}else{if(window.Prompter.View.$messageOnPrompter.scrollHeight>scrollHeight){temp=window.Prompter.View.$messageOnPrompter.textContent.slice(0,-1);toggle=true}else{clearInterval(id);window.Prompter.$showMessage.textContent=temp}}}}},{}],4:[function(require,module,exports){module.exports=function(eventName,customEventInit){var evnt=new CustomEvent(eventName,customEventInit);Prompter.$body.dispatchEvent(evnt)}},{}],5:[function(require,module,exports){var parseInput=require("./parseInput.js");module.exports=function(event){var fontColor="";var timeLeftSeconds=Infinity;switch(event.detail.type){case"count-up":if(event.detail.deadline!=="0:00"){timeLeftSeconds=parseInput(event.detail.deadline).value-parseInput(event.detail.time).value}break;case"count-down":timeLeftSeconds=parseInput(event.detail.time).value;break;case"deadline":timeLeftSeconds=parseInput(event.detail.time).value;break}if(timeLeftSeconds>120){fontColor=""}else if(timeLeftSeconds>60){fontColor="#ffa500"}else if(timeLeftSeconds>=0){fontColor="#f00"}else{fontColor="#ff00fe"}var fontSize=undefined;var minFontSize=23;var maxFontSize=40;var minStringLength=4;var maxStringLength=8;fontSize=Math.floor(minFontSize+(maxStringLength-event.detail.time.length)*(maxFontSize-minFontSize)/(maxStringLength-minStringLength));return{color:fontColor,size:fontSize+"vw"}}},{"./parseInput.js":8}],6:[function(require,module,exports){window.onload=function(){window.Prompter={$body:document.querySelector("body"),$buttonCountUp:document.querySelector("button#up"),$buttonCountDown:document.querySelector("button#down"),$inputAndDisplayTime:document.querySelector("input#time"),$buttonCountDeadline:document.querySelector("button#deadline_start"),$buttonReset:document.querySelector("button#reset"),$inputMessage:document.querySelector("textarea#message"),$showTimeLeft:document.querySelector("div#time_left"),$showMessage:document.querySelector("div#message_show"),View:{}};var Controller=require("./controller.js");var View=require("./view.js");require("./secondsEventEmitter.js");var controller=new Controller;var view=new View}},{"./controller.js":1,"./secondsEventEmitter.js":9,"./view.js":10}],7:[function(require,module,exports){var convertToString=require("./convertTimeFromSecondsToString.js");var emit=require("./emitEvent");var Timer=function(typeOfTimer,enteredTimeInSeconds){var that=this;this.emit=emit;this.type=typeOfTimer;switch(typeOfTimer){case"count-up":this.timerValue=0;this.deadline=enteredTimeInSeconds;this.timeLeft=function(){that.timerValue++;that.emit("timerChanged",customDetail());if(that.timerValue===that.deadline&&that.deadline){that.emit("timeOver",customDetail())}};this.pause=function(){window.Prompter.$body.removeEventListener("newSecond",that.timeLeft);that.paused=true;that.emit("timerPaused",customDetail())};this.run=function(){window.Prompter.$body.addEventListener("newSecond",that.timeLeft);that.paused=false;that.emit("timerRun",customDetail())};break;case"count-down":this.timerValue=enteredTimeInSeconds?enteredTimeInSeconds:3599;this.deadline=0;this.timeLeft=function(){that.timerValue--;that.emit("timerChanged",customDetail());if(that.timerValue===0){that.pause();that.emit("timeOver",customDetail())}};this.pause=function(){window.Prompter.$body.removeEventListener("newSecond",that.timeLeft);that.paused=true;that.emit("timerPaused",customDetail())};this.run=function(){window.Prompter.$body.addEventListener("newSecond",that.timeLeft);that.paused=false;that.emit("timerRun",customDetail())};break;case"deadline":var enteredTime=convertToString(enteredTimeInSeconds,true);this.deadline=new Date;this.deadline.setHours(+enteredTime.substring(0,2));this.deadline.setMinutes(+enteredTime.substring(3,5));this.deadline.setSeconds(+enteredTime.substring(6));if(this.deadline<new Date){this.deadline.setDate(this.deadline.getDate()+1)}this.deadline.fromDateToString=function(){return that.deadline.getHours()+":"+that.deadline.getMinutes()+":"+that.deadline.getSeconds()};this.timerValue=Math.floor((this.deadline-new Date)/1e3);this.timeLeft=function(){that.timerValue=Math.floor((that.deadline-new Date)/1e3);that.emit("timerChanged",customDetail());if(that.timerValue===0){window.Prompter.$body.removeEventListener("newSecond",that.timeLeft);that.emit("timeOver",customDetail())}};break}this.cancel=function(){window.Prompter.$body.removeEventListener("newSecond",that.timeLeft);that.emit("timerCancelled",customDetail())};this.emit("timerStarted",customDetail());window.Prompter.$body.addEventListener("newSecond",that.timeLeft);function customDetail(){return{detail:{type:typeOfTimer,time:convertToString(that.timerValue),deadline:typeOfTimer==="deadline"?that.deadline.fromDateToString():convertToString(that.deadline)}}}return this};module.exports=Timer},{"./convertTimeFromSecondsToString.js":2,"./emitEvent":4}],8:[function(require,module,exports){module.exports=function(timeString){if(!timeString){timeString=Prompter.$inputAndDisplayTime.value?Prompter.$inputAndDisplayTime.value:0}var result={value:NaN,isValid:false};if(isNaN(timeString)){var validChars=[0,1,2,3,4,5,6,7,8,9,":"];var timeNumber=0;for(var i=0;i<timeString.length;i++){var isCharValid=validChars.some(function(item){return timeString[i]==item});if(!isCharValid){alert("Допустимо вводить только цифры и двоеточия.");return result}if(timeString[i]!==":"){timeNumber=timeNumber*10+ +timeString[i]}}}else timeNumber=timeString;var hours=Math.floor(timeNumber/1e4);if(hours>23){alert("Значение 'часов' больше 23.");return result}var minutes=Math.floor((timeNumber-hours*1e4)/100);if(minutes>59){alert("Значение 'минут' больше 59.");return result}var seconds=Math.floor(timeNumber-hours*1e4-minutes*100);if(seconds>59){alert("Значение 'секунд' больше 59.");return result}var timeInSeconds=hours*3600+minutes*60+seconds;return result={value:timeInSeconds,isValid:true}}},{}],9:[function(require,module,exports){var emit=require("./emitEvent");var currentTimeInSeconds=Math.floor(Date.now()/1e3);var intervalID=setInterval(emitEventEverySecond,100);function emitEventEverySecond(){var newTimeInSeconds=Math.floor(Date.now()/1e3);if(currentTimeInSeconds!==newTimeInSeconds){currentTimeInSeconds=newTimeInSeconds;emit("newSecond")}}},{"./emitEvent":4}],10:[function(require,module,exports){var parseInput=require("./parseInput.js");var toStr=require("./convertTimeFromSecondsToString.js");var fontFormat=require("./fontFormat.js");var cutContentToFit=require("./cutContentToFitDiv.js");var View=function(){var that=this;this._state={_prompterState:"prompter-off",prompterStateSet:function(str){if(str==="prompter-off"||str==="prompter-on"){that._state._prompterState=str;that._state._send()}else throw Error},_timerState:"no-timer",timerStateSet:function(str){if(str==="no-timer"||str==="count-up"||str==="count-up-paused"||str==="count-up-over"||str==="count-down"||str==="count-down-paused"||str==="count-down-over"||str==="deadline"||str==="deadline-over"){that._state._timerState=str;that._state._send()}else throw Error},_send:function(){Prompter.$body.className=that._state._prompterState+" "+that._state._timerState}};that._state._send();this._$prompterWindowButtonOnOff=document.querySelector("button#screen2");this._prompterWindow=null;window.Prompter.View.$timeOnPrompter=null;window.Prompter.View.$messageOnPrompter=null;this._processKeyDown=function(event){if(event.keyCode===13){that._processMessage();event.preventDefault()}else if(event.keyCode===27){Prompter.$inputMessage.value=""}};this._processMessage=function(){if(that._state._prompterState==="prompter-on"){that._showMessage()}else{that._openPrompterWindow()}};this._showMessage=function(){window.Prompter.View.$messageOnPrompter.textContent=Prompter.$showMessage.textContent=Prompter.$inputMessage.value;Prompter.$inputMessage.value="";cutContentToFit()};this._timerStarted=function(event){that._state.timerStateSet(event.detail.type);that._showTimeOnPrompter(event);switch(event.detail.type){case"count-up":case"deadline":Prompter.$inputAndDisplayTime.value=event.detail.deadline;break;case"count-down":Prompter.$inputAndDisplayTime.value=event.detail.time;break}};this._timerPaused=function(event){that._state.timerStateSet(event.detail.type+"-paused");that._showTimeOnPrompter(event)};this._timerRun=function(event){that._state.timerStateSet(event.detail.type);that._showTimeOnPrompter(event)};this._timerCancelled=function(event){that._state.timerStateSet("no-timer");window.Prompter.View.$timeOnPrompter.textContent=Prompter.$showTimeLeft.textContent="";Prompter.$inputAndDisplayTime.value=""};this._timeOver=function(event){that._state.timerStateSet(event.detail.type+"-over");that._showTimeOnPrompter(event)};this._openPrompterWindow=function(){var strWindowFeatures="menubar=no, location=no, locationbar=no";strWindowFeatures+="toolbar=no, personalbar=no, status=no";strWindowFeatures+="resizable=yes, scrollbars=no,status=no";var strWindowPositionAndSize="height=300,width=500";that._prompterWindow=window.open("prompter.html","prompter",strWindowPositionAndSize+","+strWindowFeatures);if(!that._prompterWindow)return;that._prompterWindow.addEventListener("load",function(){window.Prompter.View.$timeOnPrompter=that._prompterWindow.document.querySelector("div#time_left");window.Prompter.View.$messageOnPrompter=that._prompterWindow.document.querySelector("div#message_show");that._state.prompterStateSet("prompter-on");that._showMessage();window.addEventListener("unload",that._prompterWindowCloseFunc);that._prompterWindow.addEventListener("unload",that._closePrompterWindow);that._prompterWindow.addEventListener("resize",that.cutContentToFit)})};this._closePrompterWindow=function(){window.removeEventListener("unload",that._prompterWindowCloseFunc);that._prompterWindow.removeEventListener("unload",that._closePrompterWindow);that._prompterWindow.removeEventListener("resize",that._showMessage);that._prompterWindow.close();that._prompterWindow=null;window.Prompter.View.$timeOnPrompter=null;window.Prompter.View.$messageOnPrompter=null;Prompter.$showMessage.textContent="";that._state.prompterStateSet("prompter-off")};this._prompterWindowOnOff=function(){if(that._state._prompterState==="prompter-on")that._closePrompterWindow();else that._openPrompterWindow()};this._prompterWindowCloseFunc=function(){if(that._state._prompterState==="prompter-on")that._closePrompterWindow()};this._showTimeOnPrompter=function(event){if(that._state._prompterState==="prompter-on"){var font=fontFormat(event);window.Prompter.View.$timeOnPrompter.style["font-size"]=font.size;window.Prompter.View.$timeOnPrompter.style.color=Prompter.$showTimeLeft.style.color=font.color;window.Prompter.View.$timeOnPrompter.textContent=Prompter.$showTimeLeft.textContent=event.detail.time}else{that._openPrompterWindow()}};Prompter.$inputAndDisplayTime.addEventListener("change",function(){var input=parseInput();if(input.isValid)Prompter.$inputAndDisplayTime.value=toStr(input.value)});this._$prompterWindowButtonOnOff.addEventListener("click",that._prompterWindowOnOff);Prompter.$inputMessage.addEventListener("keydown",that._processKeyDown);Prompter.$body.addEventListener("timerStarted",that._timerStarted);Prompter.$body.addEventListener("timerChanged",that._showTimeOnPrompter);Prompter.$body.addEventListener("timerPaused",that._timerPaused);Prompter.$body.addEventListener("timerRun",that._timerRun);Prompter.$body.addEventListener("timerCancelled",that._timerCancelled);Prompter.$body.addEventListener("timeOver",that._timeOver)};module.exports=View},{"./convertTimeFromSecondsToString.js":2,"./cutContentToFitDiv.js":3,"./fontFormat.js":5,"./parseInput.js":8}]},{},[6]);
